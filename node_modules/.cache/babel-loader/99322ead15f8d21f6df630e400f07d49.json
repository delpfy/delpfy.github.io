{"ast":null,"code":"import _objectSpread from\"C:/Users/cubar/source/react/react-pizza/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Users/cubar/source/react/react-pizza/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/cubar/source/react/react-pizza/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/cubar/source/react/react-pizza/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useSelector}from\"react-redux\";import{Catigories,SortPopUp,Skeleton,PizzaBlock}from\"../components\";import Pagination from\"../Pagination\";import{setCategoryId,setCurrentPage}from\"../redux/filter/slice\";import{FetchPizzas}from\"../redux/pizza/asyncActions\";import{useAppDispatch}from\"../redux/store\";import{selectFilter}from\"../redux/filter/selectors\";import{selectPizzasData}from\"../redux/pizza/selectors\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var dispatch=useAppDispatch();// const navigate = useNavigate();\nvar isSearch=React.useRef(false);// const isMounted = React.useRef(false);\nvar _useSelector=useSelector(selectPizzasData),items=_useSelector.items,status=_useSelector.status;var _useSelector2=useSelector(selectFilter),categoryId=_useSelector2.categoryId,sort=_useSelector2.sort,currentPage=_useSelector2.currentPage,searchValue=_useSelector2.searchValue;var setPage=function setPage(page){dispatch(setCurrentPage(page));};var setCategory=function setCategory(index){dispatch(setCategoryId(index));};var GetPizzas=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var order,category,sortBy,search;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:order=sort.sortProperty.includes(\"-\")?\"asc\":\"desc\";category=categoryId>0?\"&category=\".concat(categoryId):\"\";sortBy=sort.sortProperty.replace(\"-\",\"\");search=searchValue?\"&search=\".concat(searchValue):\"\";dispatch(FetchPizzas({order:order,category:category,sortBy:sortBy,currentPage:String(currentPage),search:search}));case 5:case\"end\":return _context.stop();}}},_callee);}));return function GetPizzas(){return _ref.apply(this,arguments);};}();/* React.useEffect(() => {\r\n    if (window.location.search) {\r\n      const params =qs.parse(window.location.search.substring(1)) as unknown as SearchPizzaParams;\r\n\r\n      const sort = options.find(\r\n        (obj) => obj.sortProperty === params.sortBy\r\n      );\r\n      dispatch(setFilters({\r\n        searchValue: params.search,\r\n        categoryId: Number(params.category),\r\n        currentPage: Number(params.currentPage),\r\n        sort: sort || options[0],\r\n      }));\r\n\r\n      isMounted.current = true;\r\n    }\r\n  }, []); */React.useEffect(function(){window.scrollTo(0,0);GetPizzas();},[categoryId,sort.sortProperty,isSearch.current,currentPage,searchValue]);/* React.useEffect(() => {\r\n    if (isMounted.current) {\r\n      const params = {\r\n        currentPage,\r\n        categoryId: categoryId > 0 ? categoryId : null,\r\n        sortProperty: sort.sortProperty,\r\n      };\r\n      const queryString = qs.stringify(params, { skipNulls: true });\r\n      navigate(`/?${queryString}`);\r\n    }\r\n    if (!window.location.search) {\r\n      dispatch(FetchPizzas({} as SearchPizzaParams));\r\n    }\r\n  }, [categoryId, sort.sortProperty, currentPage, searchValue]); */var skeletons=_toConsumableArray(new Array(6)).map(function(_,index){return/*#__PURE__*/_jsx(Skeleton,{},index);});var pizzas=items.map(function(item){return/*#__PURE__*/_jsx(PizzaBlock,_objectSpread({},item),item.id);});return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content__top\",children:[/*#__PURE__*/_jsx(Catigories,{value:categoryId,setCategory:setCategory}),/*#__PURE__*/_jsx(SortPopUp,{sort:sort})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"content__title\",children:\"\\u0423\\u0441\\u0456 \\u043F\\u0456\\u0446\\u0438\"}),status===\"error\"?/*#__PURE__*/_jsxs(\"div\",{className:\"content__error-info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0421\\u0442\\u0430\\u043B\\u0430\\u0441\\u044F \\u043F\\u043E\\u043C\\u0438\\u043B\\u043A\\u0430 \\uD83D\\uDE15\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435 \\u0432\\u0434\\u0430\\u043B\\u043E\\u0441\\u044F \\u043E\\u0442\\u0440\\u0438\\u043C\\u0430\\u0442\\u0438 \\u043F\\u0456\\u0446\\u0438. \\u041F\\u0435\\u0440\\u0435\\u0432\\u0456\\u0440\\u0442\\u0435 \\u0432\\u0430\\u0448\\u0435 \\u043F\\u0456\\u0434\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u043D\\u044F \\u0434\\u043E \\u0456\\u043D\\u0442\\u0435\\u0440\\u043D\\u0435\\u0442\\u0443 \\u0442\\u0430 \\u0441\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0437\\u043D\\u043E\\u0432\\u0443!\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"content__items\",children:status===\"loading\"?skeletons:pizzas}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,onChangePage:setPage})]});};export default Home;","map":{"version":3,"names":["React","useSelector","Catigories","SortPopUp","Skeleton","PizzaBlock","Pagination","setCategoryId","setCurrentPage","FetchPizzas","useAppDispatch","selectFilter","selectPizzasData","Home","dispatch","isSearch","useRef","items","status","categoryId","sort","currentPage","searchValue","setPage","page","setCategory","index","GetPizzas","order","sortProperty","includes","category","sortBy","replace","search","String","useEffect","window","scrollTo","current","skeletons","Array","map","_","pizzas","item","id"],"sources":["C:/Users/cubar/source/react/react-pizza/src/pages/Home.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Catigories, SortPopUp, Skeleton, PizzaBlock } from \"../components\";\r\nimport Pagination from \"../Pagination\";\r\nimport {setCategoryId,setCurrentPage} from \"../redux/filter/slice\";\r\nimport {FetchPizzas} from \"../redux/pizza/asyncActions\";\r\nimport { useAppDispatch } from \"../redux/store\";\r\nimport { selectFilter } from \"../redux/filter/selectors\";\r\nimport { selectPizzasData } from \"../redux/pizza/selectors\";\r\n\r\nconst Home: React.FC = () => {\r\n  const dispatch = useAppDispatch();\r\n // const navigate = useNavigate();\r\n  const isSearch = React.useRef(false);\r\n // const isMounted = React.useRef(false);\r\n  const { items, status } = useSelector(selectPizzasData);\r\n  const { categoryId, sort, currentPage, searchValue } =\r\n    useSelector(selectFilter);\r\n\r\n  const setPage = (page: number) => {\r\n    dispatch(setCurrentPage(page));\r\n  };\r\n  const setCategory = (index: number) => {\r\n    dispatch(setCategoryId(index));\r\n  };\r\n\r\n  const GetPizzas = async () => {\r\n    const order = sort.sortProperty.includes(\"-\") ? \"asc\" : \"desc\";\r\n    const category = categoryId > 0 ? `&category=${categoryId}` : \"\";\r\n    const sortBy = sort.sortProperty.replace(\"-\", \"\");\r\n    const search = searchValue ? `&search=${searchValue}` : \"\";\r\n\r\n    dispatch(\r\n      FetchPizzas({\r\n        order,\r\n        category,\r\n        sortBy,\r\n        currentPage: String(currentPage),\r\n        search,\r\n      })\r\n    );\r\n  };\r\n  /* React.useEffect(() => {\r\n    if (window.location.search) {\r\n      const params =qs.parse(window.location.search.substring(1)) as unknown as SearchPizzaParams;\r\n\r\n      const sort = options.find(\r\n        (obj) => obj.sortProperty === params.sortBy\r\n      );\r\n      dispatch(setFilters({\r\n        searchValue: params.search,\r\n        categoryId: Number(params.category),\r\n        currentPage: Number(params.currentPage),\r\n        sort: sort || options[0],\r\n      }));\r\n\r\n      isMounted.current = true;\r\n    }\r\n  }, []); */\r\n\r\n  React.useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n    GetPizzas();\r\n  }, [\r\n    categoryId,\r\n    sort.sortProperty,\r\n    isSearch.current,\r\n    currentPage,\r\n    searchValue,\r\n  ]);\r\n\r\n  /* React.useEffect(() => {\r\n    if (isMounted.current) {\r\n      const params = {\r\n        currentPage,\r\n        categoryId: categoryId > 0 ? categoryId : null,\r\n        sortProperty: sort.sortProperty,\r\n      };\r\n      const queryString = qs.stringify(params, { skipNulls: true });\r\n      navigate(`/?${queryString}`);\r\n    }\r\n    if (!window.location.search) {\r\n      dispatch(FetchPizzas({} as SearchPizzaParams));\r\n    }\r\n  }, [categoryId, sort.sortProperty, currentPage, searchValue]); */\r\n\r\n  const skeletons = [...new Array(6)].map((_, index) => (\r\n    <Skeleton key={index} />\r\n  ));\r\n  const pizzas = items.map((item: any) => (\r\n    <PizzaBlock key={item.id} {...item} />\r\n  ));\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"content__top\">\r\n        <Catigories value={categoryId} setCategory={setCategory} />\r\n        <SortPopUp sort={sort}/>\r\n      </div>\r\n      <h2 className=\"content__title\">–£—Å—ñ –ø—ñ—Ü–∏</h2>\r\n      {status === \"error\" ? (\r\n        <div className=\"content__error-info\">\r\n          <h2>–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ üòï</h2>\r\n          <p>–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ—Ü–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–∞—à–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Ç–∞ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É!</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"content__items\">\r\n          {status === \"loading\" ? skeletons : pizzas}\r\n        </div>\r\n      )}\r\n      <Pagination currentPage={currentPage} onChangePage={setPage} />\r\n    </div>\r\n  );\r\n};\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}